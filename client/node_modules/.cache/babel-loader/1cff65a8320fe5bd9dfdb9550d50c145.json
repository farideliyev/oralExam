{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ferid\\\\Desktop\\\\Polito\\\\Katya\\\\client\\\\src\\\\components\\\\Admin\\\\Add_Session\\\\addSession.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport { Form, Button, Col } from 'react-bootstrap';\n\nconst AddSession = () => {\n  const [isChecked, setIsChecked] = useState(false);\n  const [courses, setCourses] = useState(\"\");\n  const [students, setStudents] = useState([]);\n  const [selectedCourse, setSelectedCourse] = useState(null);\n  const [startDate, setStartDate] = useState(\"\");\n  const [startTime, setStartTime] = useState(\"\");\n  const [slotDuration, setSlotDuration] = useState(0);\n  const [sessionDuration, setSessionDuration] = useState(0);\n  const [numOfSessions, setNumOfSessions] = useState(0);\n  useEffect(() => {\n    getCourses();\n    getAvailableStudents();\n    if (slotDuration && sessionDuration) calculateNumOfSessions();\n  }, [slotDuration, sessionDuration]); // fetch to get courses\n\n  const getCourses = async () => {\n    let response = await fetch(\"http://localhost:3000/api/courses/all\");\n    let responseJson = await response.json();\n    setCourses(responseJson);\n  }; //make fetch to extract available students\n\n\n  const getAvailableStudents = async () => {\n    let response = await fetch(\"http://localhost:3000/api/students/available\");\n    let responseJson = await response.json();\n    setStudents(responseJson);\n  }; //make calculate session work\n\n\n  const calculateNumOfSessions = () => {\n    let sessionDurationInMinutes = sessionDuration * 60;\n    let numbOfStudentsForOneSlot = sessionDurationInMinutes / slotDuration;\n\n    if (numbOfStudentsForOneSlot >= students.length) {\n      setNumOfSessions(1);\n    } else if (numbOfStudentsForOneSlot < students.length) {\n      setNumOfSessions(Math.ceil(students.length / numbOfStudentsForOneSlot));\n    }\n  };\n\n  const fetchToDB = async () => {\n    let sessionStartDateTime = startDate + \" \" + startTime + \":00\"; //month\n\n    let month = new Date(startDate);\n    let monthForDB = month.toLocaleString('en-En', {\n      month: 'long'\n    }); // last date for session\n\n    let lastDateForSession = new Date(startDate);\n    lastDateForSession.setDate(lastDateForSession.getDate() + (numOfSessions - 1));\n    let lastDateForSessionForDB = lastDateForSession.getFullYear() + \"-\" + (lastDateForSession.getMonth() + 1) + \"-\" + lastDateForSession.getDate(); // last Time For Slot\n\n    let lastTimeForSlot = new Date(sessionStartDateTime);\n    lastTimeForSlot.setHours(lastTimeForSlot.getHours() + sessionDuration);\n    let lasTimeForSlotForDB = lastTimeForSlot.toLocaleTimeString();\n\n    try {\n      debugger;\n      let response = await fetch(\"http://localhost:3000/api/exams/add\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          examCrsName: selectedCourse,\n          examAllSess: numOfSessions,\n          examSessDr: sessionDuration,\n          examMonth: monthForDB,\n          examStartDate: startDate,\n          examStartTime: sessionStartDateTime,\n          examEndDate: lastDateForSessionForDB,\n          examEndTime: lasTimeForSlotForDB,\n          examSlotDuration: slotDuration\n        }),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (response.status === 200) {\n        console.log(\"PERFECT\");\n      }\n    } catch (err) {\n      alert(err);\n    }\n  }; //send created call to db\n\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    await fetchToDB();\n  };\n\n  const handleCheck = e => {\n    console.log(e);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Form, {\n    row: true,\n    sm: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, \"Add an exam session for Course\", /*#__PURE__*/React.createElement(\"select\", {\n    required: true,\n    onChange: e => setSelectedCourse(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    disabled: true,\n    selected: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 21\n    }\n  }, \"Please select...\"), courses ? courses.map((val, index) => {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: index,\n      name: val.crsName,\n      value: val.crsName,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 32\n      }\n    }, val.crsName);\n  }) : /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 27\n    }\n  }, \"Loading\"))), /*#__PURE__*/React.createElement(Form.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    as: Col,\n    controlId: \"frmstudentnum\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    style: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 21\n    }\n  }, \"Number of students for this course is  \", /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 63\n    }\n  }, \" \", students.length), \" \"))), /*#__PURE__*/React.createElement(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 17\n    }\n  }, \"List of available students\"), /*#__PURE__*/React.createElement(Form.Control, {\n    as: \"select\",\n    defaultValue: \"Choose...\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  }, students ? students.map(val => {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 33\n      }\n    }, `${val.name} ${val.surname} (${val.student_id})`);\n  }) : /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 26\n    }\n  }, \"Loading\"))), /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"sessiondate\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 17\n    }\n  }, \"Start date of the exam session\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"date\",\n    onChange: e => setStartDate(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"sessiontime\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 17\n    }\n  }, \"Start time of the exam session\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"time\",\n    onChange: e => setStartTime(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(Form.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"slotDuration\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 21\n    }\n  }, \"Duration of the slot(minutes)\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"number\",\n    min: \"1\",\n    max: \"60\",\n    placeholder: \"10\",\n    onChange: e => {\n      setSlotDuration(Number(e.target.value));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"sessionDuration\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 21\n    }\n  }, \"Duration of the session(hours)\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"number\",\n    min: \"1\",\n    max: \"60\",\n    placeholder: \"10\",\n    onChange: e => {\n      setSessionDuration(Number(e.target.value));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"studNumForSession\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 21\n    }\n  }, \"Number of students for this exam session\"), /*#__PURE__*/React.createElement(Form.Control, {\n    id: \"studNumForSession\",\n    min: \"1\",\n    placeholder: \"10\",\n    value: students.length,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"allNumOfSessions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }\n  }, \"Number of needed sessions\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"allNumOfSessions\",\n    id: \"allNumOfSessions\",\n    value: numOfSessions,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    id: \"formGridCheckbox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Check, {\n    checked: isChecked,\n    type: \"checkbox\",\n    label: \"I have checked all credentials and accepting the creation of the exam\",\n    onChange: async e => {\n      await setIsChecked(!e.target.checked);\n      console.log(e.target.checked);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    type: \"submit\",\n    style: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    onClick: e => handleSubmit(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }, \"Add the new session\")));\n};\n\nexport default AddSession;","map":{"version":3,"sources":["C:/Users/ferid/Desktop/Polito/Katya/client/src/components/Admin/Add_Session/addSession.jsx"],"names":["React","useEffect","useState","Form","Button","Col","AddSession","isChecked","setIsChecked","courses","setCourses","students","setStudents","selectedCourse","setSelectedCourse","startDate","setStartDate","startTime","setStartTime","slotDuration","setSlotDuration","sessionDuration","setSessionDuration","numOfSessions","setNumOfSessions","getCourses","getAvailableStudents","calculateNumOfSessions","response","fetch","responseJson","json","sessionDurationInMinutes","numbOfStudentsForOneSlot","length","Math","ceil","fetchToDB","sessionStartDateTime","month","Date","monthForDB","toLocaleString","lastDateForSession","setDate","getDate","lastDateForSessionForDB","getFullYear","getMonth","lastTimeForSlot","setHours","getHours","lasTimeForSlotForDB","toLocaleTimeString","method","body","JSON","stringify","examCrsName","examAllSess","examSessDr","examMonth","examStartDate","examStartTime","examEndDate","examEndTime","examSlotDuration","headers","status","console","log","err","alert","handleSubmit","e","preventDefault","handleCheck","target","value","map","val","index","crsName","display","alignItems","justifyContent","name","surname","student_id","Number","checked"],"mappings":"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","sourcesContent":["import React,{useEffect, useState} from 'react';\r\nimport {Form,Button, Col, } from 'react-bootstrap'\r\n\r\nconst AddSession=()=>{\r\n    const [isChecked, setIsChecked]=useState(false)\r\n    const [courses, setCourses]=useState(\"\");\r\n    const [students, setStudents]=useState([]);\r\n    const [selectedCourse, setSelectedCourse]=useState(null)\r\n    const [startDate, setStartDate]=useState(\"\")\r\n    const [startTime, setStartTime]=useState(\"\")\r\n    const [slotDuration, setSlotDuration]=useState(0)\r\n    const [sessionDuration, setSessionDuration]=useState(0)\r\n    const [numOfSessions, setNumOfSessions]=useState(0)\r\n\r\n    useEffect(()=>{\r\n        getCourses();\r\n        getAvailableStudents();\r\n        if(slotDuration && sessionDuration) calculateNumOfSessions()\r\n    }, [slotDuration, sessionDuration])\r\n\r\n    // fetch to get courses\r\n    const getCourses=async ()=>{\r\n        let response= await fetch(\"http://localhost:3000/api/courses/all\")\r\n        let responseJson=await response.json()\r\n        setCourses(responseJson);\r\n    }\r\n\r\n        //make fetch to extract available students\r\n    const getAvailableStudents=async ()=>{\r\n        let response= await fetch(\"http://localhost:3000/api/students/available\")\r\n        let responseJson=await response.json()\r\n        setStudents(responseJson);\r\n    }\r\n\r\n        //make calculate session work\r\n\r\n       const calculateNumOfSessions=()=>{\r\n\r\n         let sessionDurationInMinutes=sessionDuration * 60;\r\n         let numbOfStudentsForOneSlot=sessionDurationInMinutes/slotDuration;\r\n         if(numbOfStudentsForOneSlot>=students.length){\r\n             setNumOfSessions(1)\r\n         } else if(numbOfStudentsForOneSlot<students.length) {\r\n             setNumOfSessions(Math.ceil(students.length / numbOfStudentsForOneSlot));\r\n         }\r\n       }\r\n\r\n    const fetchToDB = async()=> {\r\n        let sessionStartDateTime=startDate + \" \" + startTime+\":00\";\r\n        //month\r\n        let month = new Date(startDate);\r\n        let monthForDB=month.toLocaleString('en-En', { month: 'long' });\r\n\r\n        // last date for session\r\n         let lastDateForSession=new Date(startDate);\r\n         lastDateForSession.setDate(lastDateForSession.getDate()+(numOfSessions-1));\r\n         let lastDateForSessionForDB=\r\n           lastDateForSession.getFullYear() + \"-\" + (lastDateForSession.getMonth() + 1) + \"-\"+ lastDateForSession.getDate();\r\n\r\n         // last Time For Slot\r\n        let lastTimeForSlot=new Date(sessionStartDateTime);\r\n         lastTimeForSlot.setHours(lastTimeForSlot.getHours()+sessionDuration);\r\n        let lasTimeForSlotForDB=lastTimeForSlot.toLocaleTimeString()\r\n\r\n        try{\r\n            debugger;\r\n            let response= await fetch(\"http://localhost:3000/api/exams/add\", {\r\n                method: \"POST\",\r\n                body: JSON.stringify({\r\n                    examCrsName:selectedCourse,\r\n                    examAllSess:numOfSessions,\r\n                    examSessDr:sessionDuration,\r\n                    examMonth:monthForDB,\r\n                    examStartDate:startDate,\r\n                    examStartTime: sessionStartDateTime,\r\n                    examEndDate: lastDateForSessionForDB,\r\n                    examEndTime:lasTimeForSlotForDB,\r\n                    examSlotDuration:slotDuration\r\n                }),\r\n                headers :{\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            });\r\n            if(response.status===200){\r\n                console.log(\"PERFECT\")\r\n            }\r\n        } catch (err){\r\n           alert(err)\r\n        }\r\n\r\n    }\r\n    //send created call to db\r\n       const handleSubmit= async(e)=> {\r\n        e.preventDefault();\r\n       await fetchToDB();\r\n       }\r\n\r\n       const handleCheck=(e)=>{\r\n        console.log(e)\r\n       }\r\n\r\n    return(\r\n        <>\r\n        <Form row sm={4}>\r\n            <h3>Add an exam session for Course\r\n                <select required onChange={e=>setSelectedCourse(e.target.value)} >\r\n                    <option disabled selected>Please select...</option>\r\n                    {courses\r\n                        ?\r\n                        courses.map((val,index)=>{\r\n                           return (\r\n                               <option key={index} name={val.crsName} value={val.crsName}>{val.crsName}</option>\r\n                           )\r\n                        })\r\n                        : <option>Loading</option>\r\n                    }\r\n                </select>\r\n            </h3>\r\n            <Form.Row >\r\n                <Form.Group as={Col} controlId=\"frmstudentnum\">\r\n                    <Form.Label style={{\r\n                        display: 'flex',\r\n                        alignItems: 'center',\r\n                        justifyContent: 'center',\r\n                    }}>Number of students for this course is  <strong> { students.length}</strong> </Form.Label>\r\n                </Form.Group>\r\n            </Form.Row>\r\n            <Form.Group>\r\n                <Form.Label>List of available students</Form.Label>\r\n                <Form.Control as=\"select\" defaultValue=\"Choose...\">\r\n                    {students\r\n                        ? students.map((val)=>{\r\n                            return (\r\n                                <option>{`${val.name} ${val.surname} (${val.student_id})`}</option>\r\n                            )\r\n                        })\r\n\r\n                        :<option>Loading</option>\r\n                    }\r\n                </Form.Control>\r\n            </Form.Group>\r\n\r\n            <Form.Group controlId=\"sessiondate\">\r\n                <Form.Label>Start date of the exam session</Form.Label>\r\n                <Form.Control type=\"date\" onChange={\r\n                    (e)=>setStartDate(e.target.value)}/>\r\n            </Form.Group>\r\n\r\n            <Form.Group controlId=\"sessiontime\">\r\n                <Form.Label>Start time of the exam session</Form.Label>\r\n                <Form.Control\r\n                    type=\"time\"\r\n                    onChange={\r\n                        (e)=>setStartTime(e.target.value)}\r\n                />\r\n            </Form.Group>\r\n\r\n            <Form.Row>\r\n                <Form.Group  controlId=\"slotDuration\">\r\n                    <Form.Label>Duration of the slot(minutes)</Form.Label>\r\n                    <Form.Control type=\"number\" min=\"1\" max=\"60\" placeholder=\"10\" onChange={e=>{setSlotDuration(Number(e.target.value))}} />\r\n                </Form.Group>\r\n\r\n                <Form.Group  controlId=\"sessionDuration\">\r\n                    <Form.Label>Duration of the session(hours)</Form.Label>\r\n                    <Form.Control type=\"number\" min=\"1\" max=\"60\" placeholder=\"10\"  onChange={e=>{setSessionDuration(Number(e.target.value))}} />\r\n                </Form.Group>\r\n\r\n                <Form.Group controlId=\"studNumForSession\">\r\n                    <Form.Label>Number of students for this exam session</Form.Label>\r\n                    <Form.Control  id=\"studNumForSession\" min=\"1\"  placeholder=\"10\" value={students.length} />\r\n                </Form.Group>\r\n\r\n                <Form.Group  controlId=\"allNumOfSessions\">\r\n                    <Form.Label>Number of needed sessions</Form.Label>\r\n                      <Form.Control type=\"allNumOfSessions\"  id=\"allNumOfSessions\" value={numOfSessions}/>\r\n                </Form.Group>\r\n            </Form.Row>\r\n\r\n            <Form.Group id=\"formGridCheckbox\">\r\n                <Form.Check checked={isChecked} type=\"checkbox\" label=\"I have checked all credentials and accepting the creation of the exam\"\r\n                            onChange={async e=>{\r\n                                await setIsChecked(!e.target.checked);\r\n                                console.log(e.target.checked)\r\n\r\n                            }\r\n                            }/>\r\n            </Form.Group>\r\n\r\n            <Button variant=\"primary\" type=\"submit\" style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n            }} onClick={(e)=>handleSubmit(e)}>\r\n                Add the new session\r\n            </Button>\r\n        </Form>\r\n        </>\r\n\r\n    )\r\n}\r\n\r\n\r\nexport default AddSession\r\n\r\n"]},"metadata":{},"sourceType":"module"}